// components/user/AccountComponent.ets
import { GlobalUserInfo } from "../../types/Types"
import { AppStorageV2 } from "@kit.ArkUI"

@Preview
@Component
export struct AccountComponent {
  pathStack: NavPathStack = AppStorageV2.connect(NavPathStack, 'navStack', () => new NavPathStack())!
  userInfo: GlobalUserInfo = AppStorageV2.connect(GlobalUserInfo, 'globalUserInfo', () => new GlobalUserInfo())!

  @State userName: string = this.userInfo.userName
  @State collegeName: string = "è®¡ç®—æœºå­¦é™¢"
  @State healthScore: number = 85

  build() {
    Column() {
      Column() {
        Row() {
          Stack({ alignContent: Alignment.Center }) {
            Circle({ width: 80, height: 80 })
              .fill('#E6F2FF')
            Text(this.userName.substring(0, 1))
              .fontSize(24)
              .fontColor('#007DFF')
              .fontWeight(FontWeight.Bold)
          }
          .width(80)
          .height(80)

          Column() {
            Text(this.userName)
              .fontSize(20)
              .fontWeight(FontWeight.Bold)
              .fontColor('#333333')
            Text(this.collegeName)
              .fontSize(16)
              .fontColor('#666666')
              .margin({ top: 4 })
          }
          .margin({ left: 16 })
          .layoutWeight(1)
          .alignItems(HorizontalAlign.Start)
        }
        .width('100%')
        .alignItems(VerticalAlign.Center)
        .margin({ bottom: 20 })

        Text(`å¥åº·è¯„åˆ†: ${this.healthScore}`)
          .fontSize(16)
          .fontColor('#666666')
          .width('100%')
          .textAlign(TextAlign.Center)
          .padding(12)
          .backgroundColor('#F8F9FA')
          .borderRadius(8)
      }
      .width('90%')
      .padding(24)
      .backgroundColor('#FFFFFF')
      .borderRadius(12)
      .margin(16)

      // åŠŸèƒ½èœå•åŒºåŸŸ
      Column() {
        // æ¶ˆæ¯
        this.MenuItem('æ¶ˆæ¯', 'ðŸ’¬')
        // æˆ‘çš„å¥½å‹
        this.MenuItem('æˆ‘çš„å¥½å‹', 'ðŸ‘¥', 'Friend')
        // æˆ‘çš„å¸–å­
        this.MenuItem('æˆ‘çš„å¸–å­', 'ðŸ“')
        // æˆ‘çš„å°ç»„
        this.MenuItem('æˆ‘çš„å°ç»„', 'ðŸ‘¥')
      }
      .width('90%')
      .padding(16)
      .backgroundColor('#FFFFFF')
      .borderRadius(12)
      .margin({ left: 16, right: 16, bottom: 16 })
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#F5F5F5')
  }

  @Builder
  MenuItem(title: string, icon: string, route?: string) {
    Row() {
      // å›¾æ ‡
      Text(icon)
        .fontSize(20)
        .width(40)

      // æ ‡é¢˜
      Text(title)
        .fontSize(16)
        .fontColor('#333333')
        .layoutWeight(1)
        .margin({ left: 12 })

      // å³ä¾§ç®­å¤´
      Text('>')
        .fontSize(16)
        .fontColor('#CCCCCC')
    }
    .width('100%')
    .padding(16)
    .backgroundColor('#FFFFFF')
    .borderRadius(8)
    .onClick(() => {
      console.info(`ç‚¹å‡»äº†: ${title}`)
      this.pathStack.pushPathByName(route!, null, false)
    })
  }
}