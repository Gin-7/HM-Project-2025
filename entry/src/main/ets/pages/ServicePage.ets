import { AppStorageV2 } from "@kit.ArkUI"

@Preview
@Component
export struct ServicePage {
  pathStack: NavPathStack = AppStorageV2.connect(NavPathStack, 'navStack', () => new NavPathStack())!

  @State searchText: string = ''

  build() {
    Column() {
      // æœç´¢æ  TODO ðŸ”æ”¾å³è¾¹
      Row() {
        Text('ðŸ”')
          .fontSize(18)
          .fontColor('#999999')
          .margin({ right: 10 })

        TextInput({ placeholder: 'æœç´¢å¥åº·æœåŠ¡' })
          .layoutWeight(1)
          .height(42)
          .fontSize(15)
          .fontColor('#111111')
          .backgroundColor('#F2F4F6')
          .padding({ left: 14, right: 14 })
          .borderRadius(20)
          .shadow({
            color: 'rgba(0,0,0,0.06)',
            radius: 6,
            offsetX: 0,
            offsetY: 2
          })
          .onChange((value: string) => this.searchText = value)
      }
      .width('100%')
      .padding({ left: 16, right: 16, top: 16, bottom: 16 })
      .backgroundColor('#FFFFFF')
      .alignItems(VerticalAlign.Center)

      // å†…å®¹åŒºåŸŸ
      Scroll() {
        Column() {
          Column() {
            this.ServiceCard(
              'ä¸ªäººå¥åº·çœ‹æ¿',
              'ðŸ“Š',
              'å…¨é¢ç›‘æµ‹æ‚¨çš„å¥åº·æ•°æ®',
              ['è¡€æ°§', 'è¡€åŽ‹', 'è¡€ç³–', 'ä½“é‡', 'å¿ƒçŽ‡', 'ç¡çœ '],
              'Health'    // è·¯ç”±
            )
            this.ServiceCard(
              'å¥åº·è¯¾ç¨‹è¡¨',
              'ðŸ“…',
              'è§„åˆ’æ‚¨çš„å¥åº·å­¦ä¹ è®¡åˆ’',
              ['è¿åŠ¨è¯¾ç¨‹', 'é¥®é£ŸæŒ‡å¯¼', 'å¥åº·è®²åº§', 'åº·å¤è®­ç»ƒ'],
              'Course'
            )
          }
          .width('100%')
          .padding({ left: 16, right: 16, top: 16 })

          this.QuickAccess()
          this.HealthTips()
        }
      }
      .layoutWeight(1)
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#F9FAFB')
  }

  @Builder
  ServiceCard(title: string, icon: string, description: string, features: string[], routeName: string) {
    Column() {
      Row() {
        Text(icon).fontSize(24).margin({ right: 12 })
        Column() {
          Text(title).fontSize(18).fontWeight(FontWeight.Bold).fontColor('#111111')
          Text(description).fontSize(14).fontColor('#555555').margin({ top: 4 })
        }.layoutWeight(1)
      }
      .width('100%')
      .margin({ bottom: 16 })

      Flex({ wrap: FlexWrap.Wrap }) {
        ForEach(features, (feature: string) => {
          Text(feature)
            .fontSize(12)
            .fontColor('#007DFF')
            .padding({ left: 12, right: 12, top: 6, bottom: 6 })
            .backgroundColor('rgba(0,125,255,0.08)')
            .borderRadius(12)
            .margin({ right: 8, bottom: 8 })
        })
      }
      .width('100%')

      Button('è¿›å…¥', { type: ButtonType.Capsule })
        .width(80)
        .height(32)
        .fontSize(14)
        .fontColor('#FFFFFF')
        .backgroundColor('#007DFF')
        .margin({ top: 16 })
        .alignSelf(ItemAlign.End)
        .onClick(() => {
          console.info(`è¿›å…¥${title}`)
          this.pathStack.pushPathByName(routeName, null, false)
        })
    }
    .width('100%')
    .padding(20)
    .backgroundColor('#FFFFFF')
    .borderRadius(20)
    .shadow({
      color: 'rgba(0,0,0,0.08)',  // é˜´å½±é¢œè‰²
      radius: 12,                  // æ¨¡ç³ŠåŠå¾„
      offsetX: 0,                  // X æ–¹å‘åç§»
      offsetY: 4                   // Y æ–¹å‘åç§»
    })
    .margin({ bottom: 20 })
    .onClick(() => console.info(`ç‚¹å‡»å¡ç‰‡ ${title}`))
  }

  @Builder
  HealthTips() {
    Column() {
      Row() {
        Text('ðŸ’¡').fontSize(18).margin({ right: 8 })
        Text('ä»Šæ—¥å¥åº·å°è´´å£«').fontSize(16).fontWeight(FontWeight.Bold).fontColor('#111111')
      }
      .width('100%')
      .margin({ bottom: 12 })

      Column() {
        Text('â€¢ æ¯å¤©ä¿æŒ7-8å°æ—¶å……è¶³ç¡çœ ').fontSize(14).fontColor('#555555').margin({ bottom: 8 })
        Text('â€¢ å»ºè®®æ¯å¤©æ­¥è¡Œ6000æ­¥ä»¥ä¸Š').fontSize(14).fontColor('#555555').margin({ bottom: 8 })
        Text('â€¢ å¤šåƒè”¬èœæ°´æžœï¼Œå°‘æ²¹å°‘ç›').fontSize(14).fontColor('#555555')
      }
      .width('100%')
      .padding(16)
      .backgroundColor('#F2F4F6')
      .borderRadius(16)
      .shadow({
        color: 'rgba(0,0,0,0.08)',  // é˜´å½±é¢œè‰²
        radius: 12,                  // æ¨¡ç³ŠåŠå¾„
        offsetX: 0,                  // X æ–¹å‘åç§»
        offsetY: 4                   // Y æ–¹å‘åç§»
      })
    }
    .width('100%')
    .padding({ left: 16, right: 16, top: 20, bottom: 16 })
  }

  @Builder
  QuickAccess() {
    Column() {
      Text('å¿«æ·åŠŸèƒ½').fontSize(16).fontWeight(FontWeight.Bold).fontColor('#111111').margin({ bottom: 12 }).width('100%')
      Row() {
        this.QuickItem('æˆ‘çš„æ ¡å›­', 'ðŸ«', 'Campus')
        // this.QuickItem('å¥åº·è®°å½•', 'ðŸ“')
        this.QuickItem('è¿åŠ¨è®°å½•', 'ðŸ“', 'ExerciseRecord')
        this.QuickItem('è¿åŠ¨è®¡åˆ’', 'ðŸƒ', 'ExercisePlan')
      }
      .width('100%')
      .justifyContent(FlexAlign.SpaceBetween)
    }
    .width('100%')
    .padding({ left: 16, right: 16, bottom: 30 })
  }

  @Builder
  QuickItem(title: string, icon: string, route?: string) {
    Column() {
      Text(icon).fontSize(20).margin({ bottom: 8 })
      Text(title).fontSize(12).fontColor('#111111')
    }
    .width(70)
    .height(70)
    .justifyContent(FlexAlign.Center)
    .alignItems(HorizontalAlign.Center)
    .backgroundColor('#FFFFFF')
    .borderRadius(16)
    .shadow({
      color: 'rgba(0,0,0,0.08)',  // é˜´å½±é¢œè‰²
      radius: 12,                  // æ¨¡ç³ŠåŠå¾„
      offsetX: 0,                  // Xæ–¹å‘åç§»
      offsetY: 4                   // Yæ–¹å‘åç§»
    })
    .onClick(() => {
      console.info(`ç‚¹å‡»äº† ${title}`)
      this.pathStack.pushPathByName(route!, null, false)
    })
  }
}
